version: 6.{build}.0
skip_tags: true
image: Visual Studio 2022
configuration: Release
install:
- cmd: >-
    git submodule update --init --recursive

    premake5.exe vs2022 --with-version=%APPVEYOR_BUILD_VERSION%
build:
  project: build/Ultimate-ASI-Loader-Win32.sln
  verbosity: minimal
before_package:
- cmd: msbuild.exe build/Ultimate-ASI-Loader-x64.sln /t:Build /p:Configuration=Release;Platform=x64
after_build:
- cmd: release.bat
artifacts:
- path: bin\Ultimate-ASI-Loader.zip
  name: Ultimate-ASI-Loader.zip
- path: bin\Ultimate-ASI-Loader_x64.zip
  name: Ultimate-ASI-Loader_x64.zip
- path: bin\RE7Demo.InfiniteAmmo-x64.zip
  name: RE7Demo.InfiniteAmmo-x64.zip
- path: bin\MessageBox-x64.zip
  name: MessageBox-x64.zip
- path: bin\VirtualFileServer-x64.zip
  name: OverloadFromFolderDLL-x64.zip
- path: bin\ExeUnprotect-Win32.zip
  name: ExeUnprotect-Win32.zip
- path: bin\MessageBox-Win32.zip
  name: MessageBox-Win32.zip
- path: bin\MonoLoader-Win32.zip
  name: MonoLoader-Win32.zip
- path: bin\MonoLoader-x64.zip
  name: MonoLoader-x64.zip
deploy:
- provider: GitHub
  tag: demo-plugins
  release: Ultimate ASI Loader Demo Plugins
  description: Demo plugins to test or extend Ultimate ASI Loader's functionality.
  auth_token:
    secure: ugbti+bXX/7zqu39OyiPxgRPd2pQn2FEV/12ABees2fHfpZob0tWXzqD/zSYmibJ
  artifact: RE7Demo.InfiniteAmmo-x64.zip, MessageBox-x64.zip, OverloadFromFolderDLL-x64.zip, ExeUnprotect-Win32.zip, MessageBox-Win32.zip, OverloadFromFolderDLL-Win32.zip, MonoLoader-Win32.zip, MonoLoader-x64.zip, VirtualFileServer-x64.zip
  force_update: true
  on:
    branch: master